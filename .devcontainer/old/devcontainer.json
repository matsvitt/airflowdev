// For format details, see https://aka.ms/devcontainer.json. For config options, see the
// README at: https://github.com/devcontainers/templates/tree/main/src/python
// {
// 	"name": "Python 3",
// 	// Or use a Dockerfile or Docker Compose file. More info: https://containers.dev/guide/dockerfile
// 	"image": "mcr.microsoft.com/devcontainers/python:1-3.10-bookworm",

//   "remoteUser": "vscode",
//   "workspaceFolder": "/workspace",
//   "workspaceMount": "source=${localWorkspaceFolder},target=/workspace,type=bind,consistency=cached",
//   // "postCreateCommand": "pip install -r requirements.txt",
//   "postCreateCommand": "VIRTUAL_ENV=\"/workspace/.venv\" PATH=\"$VIRTUAL_ENV/bin:$PATH\" poetry install --no-interaction --no-ansi --with dev",
//   "mounts": [
// 	"source=${localEnv:HOME}/src/finvalue,target=/home/vscode/src/finvalue,type=bind,consistency=cached",
// 	"source=${localEnv:HOME}/.ssh,target=/home/vscode/.ssh,type=bind,consistency=cached"
//     ],
//   "runArgs": ["--network=pickaxe"]
// }

{
  "build": {
      "context": "..",
      "dockerfile": "./Dockerfile"
  },
//   "workspaceMount": "source=${localWorkspaceFolder},target=/opt/app-root/src/workspace/,type=bind",
//   "workspaceFolder": "/opt/app-root/src/workspace/",
"workspaceFolder": "/workspace",
"workspaceMount": "source=${localWorkspaceFolder},target=/workspace,type=bind,consistency=cached",
  "customizations": {
      "vscode": {
          "settings": {
              "python.defaultInterpreterPath": "/opt/app-root/bin/python",
              "python.formatting.autopep8Path": "/opt/app-root/bin/autopep8",
              "python.linting.pylintPath": "/opt/app-root/bin/pylint"
          },
          "extensions": [
              "ms-python.python",
              "ms-python.vscode-pylance",
              "ms-python.pylint",
              "ms-python.autopep8",
              "ms-azuretools.vscode-docker"
          ]
      }
  },
    "postCreateCommand": "poetry install --no-interaction --no-ansi --no-root --with dev",
      // "postCreateCommand": "poetry install --no-interaction --no-ansi --no-root  --with dev", poetry add --group dev pandas && 
  "runArgs": [
    "--network=pickaxe",
      "--env-file",
      ".env"
  ],
  "forwardPorts": [
      4000
  ],
  "mounts": [
    "source=${localEnv:HOME}/src/finvalue,target=/opt/app-root/src/workspace/finvalue,type=bind,consistency=cached",
    "source=${localEnv:HOME}/.ssh,target=/opt/app-root/src/workspace/.ssh,type=bind,consistency=cached"
      ]   
}
